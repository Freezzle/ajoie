<div class="planner">
  <div class="header">
    <div class="cell header-cell">
      <button class="btn btn-primary btn-sm" *ngIf="readMode" (click)="actionOpenEditing()">
        <fa-icon icon="pencil-alt"></fa-icon>
      </button>
      <button class="btn btn-primary btn-sm" *ngIf="!readMode" (click)="actionCancelEditing()">
        <fa-icon icon="ban"></fa-icon>
      </button>
      <button class="btn btn-primary btn-sm" *ngIf="!readMode" (click)="actionEmitAndCloseEditing()">
        <fa-icon icon="floppy-disk"></fa-icon>
      </button>
    </div>
    @for (hour of hours; track $index) {
      <div class="cell header-cell">{{ hour.getHours() }}h - {{ hour.getHours() + intervalHour }}h</div>
    }
  </div>

  @for (line of editingLines; track $index) {
    <div class="row">
      <div class="cell fw-bold">
        <b>{{ line.label }}</b>
      </div>
      @for (square of line.squares; track $index) {
        <div class="cell {{ !square.usable ? 'unusable' : '' }}">
          <!-- Affichage des événements existants -->
          @if (square.used) {
            @if (!readMode) {
              <div class="event {{ getColorClass(square.type) }}">
                <span class="edit-button" (click)="editEvent(square)"><fa-icon icon="repeat"></fa-icon></span>
                <span class="delete-button" (click)="removeEvent(square)"><fa-icon icon="times"></fa-icon></span>
              </div>
            } @else {
              <div class="read-event {{ getColorClass(square.type) }}">{{ square.type }}</div>
            }
          } @else {
            <!-- Affichage du bouton "+" dans les cellules vides -->
            <div *ngIf="square.usable && !readMode" class="add-button" (click)="addEvent(square)">
              <fa-icon icon="plus"></fa-icon>
            </div>
            <div class="empty-event" *ngIf="!square.usable || readMode">&nbsp;</div>
          }
        </div>
      }
    </div>
  }
  <br />
  <div *ngFor="let type of types" class="row">
    <div class="cell read-event {{ getColorClass(type) }}">{{ type }}</div>
    @for (hour of hours; track $index) {
      <div class="cell">
        <div class="result-event">{{ countPerHour(hour, type) }}</div>
      </div>
    }
  </div>
</div>
